<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>File Processor</title>
    <style>
       
/* General Styles */
body {
    font-family: 'Courier New', monospace;
    background-color: #0e0e0e; /* Dark background */
    color: #00ff00; /* Green text for hacker theme */
    margin: 0;
    padding: 0;
    text-align: center;
    overflow: visible; /* Prevent scroll bars from appearing */
}

.container {
    max-width: 90%;
    margin: 20px auto;
    background-color: #1a1a1a; /* Slightly lighter grey for contrast */
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 2px 10px rgba(0, 255, 0, 0.5); /* Green neon shadow */
    position: relative; /* Positioning for particles */
    z-index: 2; /* Layering above particles */
}

/* Header and Footer */
header {
    background-color: #000000; /* Black for header */
    padding: 10px 0;
    position: relative;
    z-index: 3; /* Layering above particles */
}

footer {
    background-color: #000000; /* Black for footer */
    padding: 10px 0;
    margin-top: 20px;
    position: relative;
    z-index: 3; /* Layering above particles */
}

/* Heading Styles */
h1 {
    font-size: 2rem;
    margin-bottom: 10px;
    text-shadow: 0 0 10px #00ff00; /* Green glow */
}

.subtitle {
    font-size: 1rem;
    margin-bottom: 20px;
}

/* File Upload Section */
.file-upload {
    margin: 20px 0;
}

.file-upload input[type="file"] {
    padding: 10px;
    border: 1px solid #00ff00; /* Green border */
    margin-right: 10px;
    font-size: 1rem;
    width: 97%;
    background-color: #333; /* Darker input background */
    color: #00ff00; /* Green text */
}

.file-upload button {
    padding: 10px 20px;
    background-color: #00ff00; /* Bright green */
    color: #000; /* Black text */
    border: none;
    cursor: pointer;
    font-size: 1rem;
    width: 100%;
    margin-top: 10px;
    border-radius: 5px;
}

.file-upload button:hover {
    background-color: #00cc00; /* Darker green on hover */
}

/* Table Styling */
table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
}

table, th, td {
    border: 1px solid #444; /* Dark grey borders */
}

th, td {
    padding: 10px;
    text-align: left;
    font-size: 1rem;
}

th {
    background-color: #00ff00; /* Bright green header */
    color: #000;
    text-shadow: 0 0 10px #00cc00; /* Green glow */
}

td {
    background-color: #444; /* Dark grey for rows */
    color: #00ff00; /* Green text */
}

/* Progress Bar */
#progressContainer {
    margin: 20px 0;
}

#progressBar {
    width: 100%;
    height: 20px;
    background-color: #555; /* Dark grey */
    border-radius: 5px;
    overflow: hidden;
}

#progressBar div {
    height: 100%;
    background-color: #00ff00; /* Bright green for the progress */
    width: 0; /* Start width */
    transition: width 0.4s; /* Smooth transition */
}

/* Download link */
a#downloadLink {
    margin-top: 20px;
    display: none;
    color: #00cc00; /* Bright green */
    font-size: 1.1rem;
}

/* Media Queries for Responsiveness */
@media (max-width: 768px) {
    .container {
        padding: 15px;
    }
    h1 {
        font-size: 1.8rem;
    }
    .subtitle {
        font-size: 0.9rem;
    }
    .file-upload input[type="file"] {
        font-size: 0.9rem;
    }
    .file-upload button {
        font-size: 0.9rem;
    }
    th, td {
        font-size: 0.9rem;
    }
}

@media (max-width: 480px) {
    h1 {
        font-size: 1.5rem;
    }
    .subtitle {
        font-size: 0.8rem;
    }
    .file-upload input[type="file"] {
        font-size: 0.85rem;
    }
    .file-upload button {
        font-size: 0.85rem;
    }
    th, td {
        font-size: 0.85rem;
    }
}
    </style>
</head>
<body>
    <header>
        <h1>File Processor</h1>
        <p class="subtitle">Upload a file, process it, and get the results with progress updates.</p>
    </header>

    <div class="container">
        <div class="file-upload">
            <input type="file" id="dumpFile">
            <button id="processDump">Process File</button>
        </div>

        <div id="progressContainer">
            <div id="progressBar">
                <div></div>
            </div>
        </div>

        <table>
            <thead>
                <tr>
                    <th>Function</th>
                    <th>Offset</th>
                    <th>Patch</th>
                </tr>
            </thead>
            <tbody id="resultsTableBody">
                <!-- Results will be dynamically populated here -->
            </tbody>
        </table>

        <a id="downloadLink" href="#">Download Extracted Data</a>
    </div>

    <footer>
        <p>&copy; 2025 File Processor. All rights reserved.</p>
    </footer>

    <script>
       const processDumpButton = document.getElementById('processDump');
const resultsTableBody = document.getElementById('resultsTableBody');
const progressBar = document.querySelector('#progressBar div');
const downloadLink = document.getElementById('downloadLink');

// Function to load the function.txt and parse its contents
function loadFunctions(fileContent) {
    const functions = [];
    const lines = fileContent.split('\n');
    lines.forEach(line => {
        const parts = line.split('|');
        if (parts.length === 3) {
            const fn = parts[0].trim();
            const fn2 = parts[1].trim();
            const patch = parts[2].trim();
            functions.push({ fn, fn2, patch });
        }
    });
    return functions;
}

processDumpButton.addEventListener('click', () => {
    const fileInput = document.getElementById('dumpFile');
    const file = fileInput.files[0];

    if (!file) {
        alert('Please upload a dump file.');
        return;
    }

    const reader = new FileReader();
    reader.onload = (event) => {
        const content = event.target.result;

        // Load function definitions from function.txt
        const functionsFile = document.getElementById('functionsFile'); // Assuming a file input for functions.txt
        const functionsReader = new FileReader();
        functionsReader.onload = (e) => {
            const functionsContent = e.target.result;
            const functions = loadFunctions(functionsContent); // Load functions from the functions.txt

            processDump(content, functions); // Process the dump using the loaded functions
        };
        functionsReader.readAsText(functionsFile); // Read the functions.txt file
    };
    reader.readAsText(file);
});

function processDump(content, functions) {
    resultsTableBody.innerHTML = '';
    progressBar.style.width = '0%';
    progressBar.textContent = '0%';

    const lines = content.split('\n');
    let extractedData = '';
    let processedCount = 0;
    const totalFunctions = functions.length;

    functions.forEach((func, index) => {
        setTimeout(() => {
            let foundOffset = 'Not found';
            lines.forEach(line => {
                if (line.includes(func.fn2)) {
                    const offsetMatch = line.match(/0x[\da-fA-F]+/);
                    if (offsetMatch) {
                        foundOffset = offsetMatch[0];
                    }
                }
            });

            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${func.fn}</td>
                <td>${foundOffset}</td>
                <td>${func.patch}</td>
            `;
            resultsTableBody.appendChild(row);

            extractedData += `Mod: ${func.fn}\nOffset: ${foundOffset}\nPatch: ${func.patch}\n\n`;

            processedCount++;
            const progress = Math.round((processedCount / totalFunctions) * 100);
            progressBar.style.width = `${progress}%`;
            progressBar.textContent = `${progress}%`;

            if (processedCount === totalFunctions) {
                finalizeProcessing(extractedData);
            }
        }, 200 * index); // Incrementally process functions with a delay
    });
}

function finalizeProcessing(data) {
    const blob = new Blob([data], { type: 'text/plain' });
    const url = URL.createObjectURL(blob);
    downloadLink.href = url;
    downloadLink.download = 'extracted_data.txt';
    downloadLink.style.display = 'block';
    downloadLink.innerText = 'Download Extracted Data';
}

    </script>
</body>
</html>
