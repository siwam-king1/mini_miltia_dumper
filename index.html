<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SK1 DUMPER</title>
    <link rel="stylesheet" href="style.css">
    <style>
        /* Add particles.js script to the HTML */
        #particles-js {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 1;
        }
    </style>
<body>

    <div class="header">
        <h1>MINI MILTIA DUMPER</h1>
    </div>

    <div class="container">
        <p class="subtitle">Upload a .txt Dump File & It Will Dump Offset From It</p>

        <!-- File Upload Section -->
        <div class="file-upload">
            <input type="file" id="dumpFile" accept=".txt" />
            <button id="processDump">Search & Extract</button>
        </div>

        <!-- Progress Bar -->
        <div class="progress-container" id="progressContainer">
            <div class="progress-bar" id="progressBar">0%</div>
        </div>

        <!-- Table to show results -->
        <table>
            <thead>
                <tr>
                    <th>Mod Name</th>
                    <th>Offset</th>
                    <th>Patch</th>
                    
                </tr>
            </thead>
            <tbody id="resultsTableBody">
                <!-- Rows will be injected here by JS -->
            </tbody>
        </table>

        <!-- Download link for the extracted result -->
        <a id="downloadLink" href="#">Download Extracted Data</a>
    </div>

    <div class="footer">
        <p>&copy; 2024 Developed by Siwam King1 </p>
    </div>

    <script>
        // Data structure containing the functions
        const functions = [
    {
        fn: "MAX LEVEL",
        fn2: "_ZNK11UserProfile5levelEv",
        patch: "6400A0E31EFF2FE1"
    },
    {
        fn: "MAX XP",
        fn2: "_ZNK11UserProfile2xpEv",
        patch: "FF090CE30010A0E39A0B43E31EFF2FE1"
    },
    {
        fn: "Fake Enemy Information",
        fn2: "_ZNK10PlayerInfo5levelEv",
        patch: "5000A0E31EFF2FE1"
    },
    {	
        fn: "Unlock Everything",
        fn2: "_ZNK10UserWallet15quantityOwnedOfERKNSt6__ndk112basic_stringIcNS0_11char_traitsIcEENS0_9allocatorIcEEEE",
        patch: "5000A0E31EFF2FE1A"
    },
    {
        fn: "MAX Level Weapon",
        fn2: "_ZNK10UserWallet22maxOwnedLevelForWeaponERKNSt6__ndk112basic_stringIcNS0_11char_traitsIcEENS0_9allocatorIcEEEE",
        patch: "5000A0E31EFF2FE1"
    },
{
    fn: "Magik Zoom2",
    fn2: "_ZN6Weapon15changeZoomLevelEv",
    patch: "00 00 55 E1 FA 15 A0 03 60 11 84 05 07 00 00 0A 00 10 A0 83 5C 11 84 85"
}

	

];


        // Function to search keywords in the dump and extract data
        function processDump(fileContent) {
            const tableBody = document.getElementById('resultsTableBody');
            const progressBar = document.getElementById('progressBar');
            const progressContainer = document.getElementById('progressContainer');
            let extractedData = '';

            // Clear previous results
            tableBody.innerHTML = '';
            progressContainer.style.display = 'block'; // Show the progress bar

            const lines = fileContent.split('\n');
            const totalFunctions = functions.length;

            // Write header information in the output
            extractedData += 'Extracted Data from Dump File\n';
            extractedData += 'Created by Siwam King 1\n\n';

            functions.forEach((func, index) => {
                // Update progress for searching function
                progressBar.innerText = `Searching for ${func.fn2}...`;
                progressBar.style.width = `${(index / totalFunctions) * 100}%`;

                // Search for the function in all lines
                let foundOffset = 'Not found';
                lines.forEach(line => {
                    if (line.includes(func.fn2)) {
                        const offsetMatch = line.match(/0x[\da-fA-F]+/);
                        if (offsetMatch) {
                            foundOffset = offsetMatch[0]; // Get the first found offset
                        }
                    }
                });

                // Update the table with results
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${func.fn}</td>
                     <td>${foundOffset}</td>
                    <td>${func.patch}</td>
                    
                `;
                tableBody.appendChild(row);

                // Collect extracted data in the specified format
                extractedData += `fn = "${func.fn}"\n`;
                extractedData += `offset = "${foundOffset !== 'Not found' ? foundOffset : 'function name is wrong'}"\n`;
                extractedData += `patch = "${func.patch}"\n\n`; // Add an extra line break for readability

                // Update progress bar to show that offset was found or not
                progressBar.innerText = foundOffset !== 'Not found' ? `Got the offset for ${func.fn2}` : `No offset found for ${func.fn2}`;
                progressBar.style.width = `${((index + 1) / totalFunctions) * 100}%`;
            });

            // Complete progress
            progressBar.innerText = 'Processing complete!';
            progressBar.style.width = '100%';

            // Trigger download of extracted data
            triggerDownload(extractedData);
        }

        // Function to trigger the download of the extracted data
        function triggerDownload(data) {
            const blob = new Blob([data], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const downloadLink = document.getElementById('downloadLink');
            downloadLink.href = url;
            downloadLink.download = 'extracted_data_sk1.txt';
            downloadLink.style.display = 'block'; // Show the download link
                        downloadLink.innerText = 'Download Extracted Data';
        }

        // Event listener for file upload and processing
        document.getElementById('processDump').addEventListener('click', () => {
            const fileInput = document.getElementById('dumpFile');
            const file = fileInput.files[0];

            if (file) {
                const reader = new FileReader();
                reader.onload = (event) => {
                    const fileContent = event.target.result;
                    processDump(fileContent);
                };
                reader.readAsText(file);
            } else {
                alert('Please upload a dump file.');
            }
        });
    </script>
	
</body>
</html>
